@model ShopDongHo.Models.ViewModels.CheckoutViewModel
@using ShopDongHo.Helpers
@{
    ViewBag.Title = "Thanh toán";
    var cart = SessionHelper.GetCart();
}

<h2 class="mb-4">Thanh toán</h2>

<div class="row">
    <div class="col-md-8">
        @using (Html.BeginForm("Create", "Order", FormMethod.Post))
        {
            @Html.AntiForgeryToken()

            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">Thông tin giao hàng</h5>
                </div>
                <div class="card-body">
                    <div class="mb-3">
                        @Html.LabelFor(m => m.CustomerName, new { @class = "form-label" })
                        @Html.TextBoxFor(m => m.CustomerName, new { @class = "form-control" })
                        @Html.ValidationMessageFor(m => m.CustomerName, "", new { @class = "text-danger" })
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            @Html.LabelFor(m => m.CustomerEmail, new { @class = "form-label" })
                            @Html.TextBoxFor(m => m.CustomerEmail, new { @class = "form-control", type = "email" })
                            @Html.ValidationMessageFor(m => m.CustomerEmail, "", new { @class = "text-danger" })
                        </div>
                        <div class="col-md-6 mb-3">
                            @Html.LabelFor(m => m.CustomerPhone, new { @class = "form-label" })
                            @Html.TextBoxFor(m => m.CustomerPhone, new { @class = "form-control", type = "tel" })
                            @Html.ValidationMessageFor(m => m.CustomerPhone, "", new { @class = "text-danger" })
                        </div>
                    </div>

                    <div class="mb-3">
                        @Html.LabelFor(m => m.CustomerAddress, new { @class = "form-label" })
                        @Html.TextAreaFor(m => m.CustomerAddress, new { @class = "form-control", rows = 3 })
                        @Html.ValidationMessageFor(m => m.CustomerAddress, "", new { @class = "text-danger" })
                    </div>

                    <div class="mb-3">
                        @Html.LabelFor(m => m.Note, "Ghi chú (tùy chọn)", new { @class = "form-label" })
                        @Html.TextAreaFor(m => m.Note, new { @class = "form-control", rows = 2 })
                    </div>
                </div>
            </div>

            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">Sản phẩm đã chọn</h5>
                </div>
                <div class="card-body">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Sản phẩm</th>
                                <th>Số lượng</th>
                                <th>Đơn giá</th>
                                <th>Thành tiền</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var item in cart)
                            {
                                <tr>
                                    <td>@item.ProductName</td>
                                    <td>@item.Quantity</td>
                                    <td>@item.Price.ToString("N0") đ</td>
                                    <td>@item.SubTotal.ToString("N0") đ</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="d-flex justify-content-between">
                @Html.ActionLink("« Quay lại giỏ hàng", "Index", "Cart", null, new { @class = "btn btn-outline-secondary" })
                <button type="submit" class="btn btn-primary btn-lg">Đặt hàng</button>
            </div>
        }
    </div>

    <div class="col-md-4">
        @{ ViewBag.ShowCheckoutButton = false; }
        @Html.Partial("_CartSummary")
    </div>
</div>

@section scripts {
    @Scripts.Render("~/bundles/jqueryval")
}
